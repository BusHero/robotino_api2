SET(
  NAME
  rec_robotinoxt
)

SET( REC_ROBOTINOXT_INCLUDE_INSTALL_DIR include/rec/robotinoxt )
SET_PROPERTY( DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} APPEND PROPERTY INCLUDE_DIRECTORIES ${QT_INCLUDE_DIR} ${QT_QTCORE_INCLUDE_DIR} )
ADD_DEFINITIONS(${QT_DEFINITIONS})

FILE( GLOB SRCS *.cpp )
FILE( GLOB PRIVATE_HEADER *.hpp )
FILE( GLOB MAIN_HEADER *.h )

SOURCE_GROUP( "Source Files" FILES ${SRCS} ${MAIN_HEADER} ${PRIVATE_HEADER} )

MY_WRAP_CPP(
	MOC_SRCS
	"${rec_robotinoxt}"
	${MAIN_HEADER}
	${PRIVATE_HEADER}
	${HEADER}
)

INCLUDE( serial/CMakeLists.txt )
	
ADD_LIBRARY(
	${NAME}
	STATIC

	${SRCS}
	${MAIN_HEADER}
	${PRIVATE_HEADER}
	${HEADER}
	${MOC_SRCS}
)

IF(WIN32)
SET_TARGET_PROPERTIES(
	${NAME}
	PROPERTIES
	COMPILE_FLAGS "/wd4251 /MP"
)
ENDIF( WIN32 )

TARGET_LINK_LIBRARIES(
	${NAME}
	rec_serialport
)

IF( WIN32 )
	TARGET_LINK_LIBRARIES(
		${NAME}
		setupapi
	)
ENDIF( WIN32 )

IF( DO_COMMON_INSTALL )
	INSTALL(
		TARGETS ${NAME}
		ARCHIVE DESTINATION lib
		LIBRARY DESTINATION lib
	#	RUNTIME DESTINATION ${BIN_INSTALL_DIR}
	)

	INSTALL(
		FILES
		${MAIN_HEADER}
		DESTINATION ${REC_ROBOTINOXT_INCLUDE_INSTALL_DIR}
)
ENDIF( DO_COMMON_INSTALL )

# For API1!
IF( INSTALL_REC_ROBOTINOXT )
	INSTALL(
		TARGETS ${NAME}
		ARCHIVE DESTINATION ${LIB_INSTALL_DIR}
		LIBRARY DESTINATION ${LIB_INSTALL_DIR}
		RUNTIME DESTINATION ${BIN_INSTALL_DIR}
	)

	INSTALL(
		FILES
		${MAIN_HEADER}
		DESTINATION ${INCLUDE_INSTALL_DIR}/rec/robotinoxt
	)
ENDIF( INSTALL_REC_ROBOTINOXT )

SOURCE_GROUP( "Source Files" FILES ${SRCS} ${HEADER} )
SOURCE_GROUP( Moc REGULAR_EXPRESSION "(moc_|qrc_)" )