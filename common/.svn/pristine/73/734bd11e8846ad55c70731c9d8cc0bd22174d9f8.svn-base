SET(
  NAME
  rec_dataexchange_lt
)

SET( REC_DATAEXCHANGE_LT_INCLUDE_INSTALL_DIR include/rec/dataexchange_lt )

FILE( GLOB SRCS *.cpp )
FILE( GLOB PRIVATE_HEADER *.hpp )
FILE( GLOB MAIN_HEADER *.h )

SOURCE_GROUP( "Source Files" FILES ${SRCS} ${MAIN_HEADER} ${PRIVATE_HEADER} )

MY_WRAP_CPP(
	MOC_SRCS
	"${rec_dataexchange}"
	${PRIVATE_HEADER}
)

INCLUDE( server/CMakeLists.txt )
INCLUDE( client/CMakeLists.txt )
INCLUDE( messages/CMakeLists.txt )
INCLUDE( configuration/CMakeLists.txt )
INCLUDE( udp/CMakeLists.txt )

#SET(
#  RCCS
#  rec_qt.qrc
#)

#QT4_ADD_RESOURCES(
#  RCC_SRCS
#  ${RCCS}
#)
	
ADD_LIBRARY(
	${NAME}
	STATIC

	${SRCS}
	${MAIN_HEADER}
	${PRIVATE_HEADER}
	${HEADER}
	${MOC_SRCS}
	
#	${RCC_SRCS}
)

TARGET_LINK_LIBRARIES(
	${NAME}
	${QT_QTCORE_LIBRARY}
	${QT_HELP_LIBRARIES}
)

IF(WIN32 AND NOT MINGW)
	SET_TARGET_PROPERTIES(
	  ${NAME}
	  PROPERTIES
	  COMPILE_FLAGS "/MP"
	)
ENDIF( WIN32 AND NOT MINGW)

INSTALL(
  TARGETS ${NAME}
  LIBRARY DESTINATION lib
  ARCHIVE DESTINATION lib
  RUNTIME DESTINATION lib
)

IF( REC_DATAEXCHANGE_TEST )
	ADD_SUBDIRECTORY( test )
ENDIF( REC_DATAEXCHANGE_TEST )

SOURCE_GROUP( Moc REGULAR_EXPRESSION "(moc_|qrc_)" )
SOURCE_GROUP( "Source Files" FILES ${SRCS} ${HEADER} )

IF( DO_COMMON_INSTALL )
	INSTALL(
		TARGETS ${NAME}
		ARCHIVE DESTINATION lib
		LIBRARY DESTINATION lib
		RUNTIME DESTINATION bin
	)

	INSTALL(
		FILES
		${MAIN_HEADER}
		DESTINATION ${REC_DATAEXCHANGE_LT_INCLUDE_INSTALL_DIR}
	)
ENDIF( DO_COMMON_INSTALL )
