SET(
	NAME
	grappler_firmware_updater
)

SET_PROPERTY( DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} APPEND PROPERTY INCLUDE_DIRECTORIES ${QT_INCLUDE_DIR} ${QT_QTCORE_INCLUDE_DIR} ${QT_QTXML_INCLUDE_DIR} ${QT_QTNETWORK_INCLUDE_DIR} ${QT_QTGUI_INCLUDE_DIR} )
ADD_DEFINITIONS(${QT_DEFINITIONS})

INCLUDE_DIRECTORIES(
	${CMAKE_CURRENT_BINARY_DIR}
)

FILE( GLOB SRCS src/*.cpp )
FILE( GLOB HEADER src/*.h )
FILE( GLOB RCCS src/*.qrc )

SET( MOC_SRCS )

MY_WRAP_CPP(
	MOC_SRCS
	"${grappler_firmware_updater}"
	${HEADER}
)

QT4_ADD_RESOURCES(
	RCC_SRCS
	${RCCS}
)

ADD_EXECUTABLE(
	${NAME}
	WIN32
	${SRCS}
	${HEADER}
	${MOC_SRCS}
	${RCC_SRCS}
)

IF(WIN32 AND NOT MINGW)
	SET_TARGET_PROPERTIES( ${NAME} PROPERTIES COMPILE_FLAGS "/MP" )
ENDIF(WIN32 AND NOT MINGW)

TARGET_LINK_LIBRARIES(
	${NAME}
	rec_serialport
	rec_grappler
	${QT_QTCORE_LIBRARY}
	${QT_QTMAIN_LIBRARY}
	${QT_QTGUI_LIBRARY}
	Ws2_32.lib
	Winmm.lib
	Imm32.lib
)

SOURCE_GROUP( "Source Files" FILES ${SRCS} ${HEADER} )
SOURCE_GROUP( Moc REGULAR_EXPRESSION "(moc_|qrc_)" )

#MAKE_RECVERSION_STR( ${NAME} "${CMAKE_CURRENT_BINARY_DIR}/debugger_version.h" ${ROBOTINO_ARM_VERSION} "RobotinoArm" "robotino_arm_debugger.exe" )

INSTALL(
	TARGETS 
	${NAME}
	DESTINATION ${BIN_INSTALL_DIR}
)
