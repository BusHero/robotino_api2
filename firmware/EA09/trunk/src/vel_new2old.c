/*
With the old IO-Board our speed measurment unit is ticks * 900Hz
The new IO-Board measures encoder ticks with 1kHz. The mapping is
old = 10/9 * new
*/

const unsigned char vel_new2old_data[256] = {
0,
1,
2,
3,
4,
6,
7,
8,
9,
10,
11,
12,
13,
14,
16,
17,
18,
19,
20,
21,
22,
23,
24,
26,
27,
28,
29,
30,
31,
32,
33,
34,
36,
37,
38,
39,
40,
41,
42,
43,
44,
46,
47,
48,
49,
50,
51,
52,
53,
54,
56,
57,
58,
59,
60,
61,
62,
63,
64,
66,
67,
68,
69,
70,
71,
72,
73,
74,
76,
77,
78,
79,
80,
81,
82,
83,
84,
86,
87,
88,
89,
90,
91,
92,
93,
94,
96,
97,
98,
99,
100,
101,
102,
103,
104,
106,
107,
108,
109,
110,
111,
112,
113,
114,
116,
117,
118,
119,
120,
121,
122,
123,
124,
126,
127,
128,
129,
130,
131,
132,
133,
134,
136,
137,
138,
139,
140,
141,
142,
143,
144,
146,
147,
148,
149,
150,
151,
152,
153,
154,
156,
157,
158,
159,
160,
161,
162,
163,
164,
166,
167,
168,
169,
170,
171,
172,
173,
174,
176,
177,
178,
179,
180,
181,
182,
183,
184,
186,
187,
188,
189,
190,
191,
192,
193,
194,
196,
197,
198,
199,
200,
201,
202,
203,
204,
206,
207,
208,
209,
210,
211,
212,
213,
214,
216,
217,
218,
219,
220,
221,
222,
223,
224,
226,
227,
228,
229,
230,
231,
232,
233,
234,
236,
237,
238,
239,
240,
241,
242,
243,
244,
246,
247,
248,
249,
250,
251,
252,
253,
254,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255,
255
};

signed short vel_new2old( signed short new )
{
	unsigned char newabs;
	unsigned char newsign;

	if( new >= 0 )
	{ 
		if( new > 255 )
		{
			new = 255;
		}
		newabs = new;
		newsign = 1;
	}
	else if( new < 0 )
	{
		if( new < -255 )
		{
			new = -255;
		}
		newabs = -new;
		newsign = 0;
	}

	if( 1 == newsign )
	{
		return vel_new2old_data[newabs];
	}
	else
	{
		return - vel_new2old_data[newabs];
	}
}
